<!DOCTYPE html>

<html lang="en">
<head>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard Estimasi</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha512-..." crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body class="flex h-screen">

  <!-- Sidebar -->

  <aside class="w-64 bg-gray-800 text-white p-4 space-y-4">
    <h2 class="text-xl font-bold mb-4">Dashboard</h2>
    <nav>
  
    <ul class="text-white text-sm space-y-2">
        <li><button onclick="showSection('layout-a3')"class="flex items-center space-x-2 px-4 py-2 hover:bg-gray-700 cursor-pointer">
            <i class="fas fa-layer-group text-white"></i>
            <span>Layout A3+</span></li>
        <li><button onclick="showSection('buku')"class="flex items-center space-x-2 px-4 py-2 hover:bg-gray-700 cursor-pointer">
            <i class="fas fa-book text-white"></i>
            <span>Buku</span></li>
        <li><button onclick="showSection('spanduk')"class="flex items-center space-x-2 px-4 py-2 hover:bg-gray-700 cursor-pointer">
            <i class="fas fa-image text-white"></i>
            <span>Spanduk</span></li>
        <li><button onclick="showSection('adjust-size')"class="flex items-center space-x-2 px-4 py-2 hover:bg-gray-700 cursor-pointer">
            <i class="fas fa-expand-arrows-alt text-white"></i>
            <span>Adjust Size</span></li>
        <li><button onclick="showSection('shuffle-pages')"class="flex items-center space-x-2 px-4 py-2 hover:bg-gray-700 cursor-pointer">
            <i class="fas fa-random text-white"></i>
            <span>Shuffle Pages</span></li>
        <li><button onclick="showSection('penawaran-harga')"class="flex items-center space-x-2 px-4 py-2 hover:bg-gray-700 cursor-pointer">
            <i class="fas fa-file-invoice-dollar text-white"></i>
            <span>Penawaran Harga</span></li>
        <li><button onclick="showSection('pengiriman')"class="flex items-center space-x-2 px-4 py-2 hover:bg-gray-700 cursor-pointer">
            <i class="fas fa-truck text-white"></i>
            <span>Pengiriman</span></li>
      </ul>
    </nav>
  </aside>

  <!-- Layout A3+ -->

<main class="flex-1 p-6 overflow-auto"> 
<div id="layout-a3" class="section hidden">
  <h1 class="text-2xl font-semibold mb-4">Estimasi Layout A3+</h1>
  <table class="mb-4">
    <tr>

  <td class="pr-2 py-3">Ukuran Jadi (cm):</td>
  <td>
    <div class="flex ml-2 w-64">
      <input type="number" placeholder="Panjang" id="panjang" class="p-1 border rounded w-[7.25rem] mr-1" />
      <span class="flex items-center px-1">x</span>
      <input type="number" placeholder="Lebar" id="lebar" class="p-1 border rounded w-[7.25rem] ml-1" />
    </div>
  </td>
</tr>

    <tr>
      <td class="pr-2 py-3">Kebutuhan Cetak (pcs):</td>
      <td><input type="number" id="kebutuhan" class="ml-2 p-1 border rounded w-64" /></td>
    </tr>

    <tr>
      <td class="pr-2 py-3">Finishing:</td>
      <td>
        <select id="finishing" class="ml-2 p-1 border rounded w-64">
          <option value="">-- Pilih Finishing --</option>
          <option value="Potong Kotak Kress 1">Potong Kotak Kress 1</option>
          <option value="Potong Kotak Kress 2">Potong Kotak Kress 2</option>
          <option value="Kiss Cut">Kiss Cut</option>
          <option value="Die Cut">Die Cut</option>
        </select>
      </td>
    </tr>

    <tr>
      <td class="pr-2 py-3">Total dalam 1 A3:</td>
      <td><input type="text" id="hasilTotalA3" class="ml-2 p-1 border rounded w-64 bg-gray-100" readonly /></td>
    </tr>

    <tr>
      <td class="pr-2 py-3">Kebutuhan Cetak A3+:</td>
      <td><input type="text" id="hasilA3plus" class="ml-2 p-1 border rounded w-64 bg-gray-100" readonly /></td>
    </tr>

    <tr>
      <td class="pr-2 py-3">Total Biaya Finishing:</td>
      <td><input type="text" id="totalFinishing" class="ml-2 p-1 border rounded w-64 bg-gray-100" readonly /></td>
    </tr>
  </table>

  <div class="mt-4">
    <button onclick="hitungTotal()" class="px-4 py-2 bg-blue-600 text-white rounded">Hitung</button>
    <button onclick="resetForm()" class="ml-2 px-4 py-2 bg-gray-500 text-white rounded">Reset</button>
  </div>
</div>
    </div> <!-- penutup layout-a3 -->

    <!-- Buku -->

  <main class="flex-1 p-6 overflow-auto">
    <div id="buku" class="section hidden">
      <h2 class="text-2xl font-bold mb-4">Estimasi Buku</h2>
      <label for="jenis-buku" class="block mb-2 font-semibold">Pilih Jenis Buku:</label>
      <select id="jenis-buku" onchange="tampilkanFormBuku()" class="mb-4 p-2 border rounded text-black">
        <option value="softcover">Soft Cover</option>
        <option value="booklet">Booklet</option>
        <option value="spiral">Spiral</option>
      </select>

   <!-- Soft Cover -->
      <div id="form-softcover" class="form-buku">
        <h3 class="font-bold mb-2">Estimasi Buku - Soft Cover</h3>

<table class="mb-4 w-[400px]">
  <tr>
    <td class="pr-2 py-2 whitespace-nowrap">Jumlah Halaman:</td>
    <td><input type="number" id="softcover-halaman" class="ml-2 p-1 border rounded w-full" /></td>
  </tr>
  <tr>

    <td class="pr-2 py-2 whitespace-nowrap">Jumlah Cetak:</td>
    <td><input type="number" id="softcover-cetak" class="ml-2 p-1 border rounded w-full" /></td>
  </tr>
  <tr>

    <td class="pr-2 py-2 whitespace-nowrap">Ukuran Jadi (cm):</td>
    <td>
      <div class="flex ml-2 w-full">
        <input type="number" placeholder="Panjang" id="softcover-panjang" class="p-1 border rounded w-1/2 mr-1" />
        <span class="flex items-center px-1">x</span>
        <input type="number" placeholder="Lebar" id="softcover-lebar" class="p-1 border rounded w-1/2 ml-1" />
      </div>
    </td>
  </tr>
  <tr>

    <td class="pr-2 py-2 whitespace-nowrap">Sided Print-Isi:</td>
    <td>
      <select id="softcover-sisi-isi" class="ml-2 p-1 border rounded w-full">
        <option value="">-- slide --</option>
        <option value="1">1 Sisi</option>
        <option value="2">2 Sisi</option>
      </select>
    </td>
  </tr>
  <tr>
    <td class="pr-2 py-2 whitespace-nowrap">Sided Print-Cover:</td>
    <td>
      <select id="softcover-sisi-cover" class="ml-2 p-1 border rounded w-full">
        <option value="">-- slide --</option>
        <option value="1">1 Sisi</option>
        <option value="2">2 Sisi</option>
      </select>
    </td>
  </tr>
  <tr>
    <td class="pr-2 py-2 whitespace-nowrap">Bahan Kertas Isi:</td>
    <td>
      <select id="softcover-bahan-isi" class="ml-2 p-1 border rounded w-full">
        <option value="">-- Pilih Kertas --</option>
        <option value="BOOK PAPER">BOOK PAPER</option>
        <option value="HVS 75 gsm">HVS 75 gsm</option>
        <option value="HVS 80 gsm">HVS 80 gsm</option>
        <option value="HVS 100 gsm">HVS 100 gsm</option>
        <option value="AP 120 gsm">AP 120 gsm</option>
        <option value="AP 150 gsm">AP 150 gsm</option>
        <option value="MP 120 gsm">MP 120 gsm</option>
        <option value="MP 150 gsm">MP 150 gsm</option>
        <option value="AC 210 gsm">AC 210 gsm</option>
        <option value="AC 230 gsm">AC 230 gsm</option>
        <option value="AC 260 gsm">AC 260 gsm</option>
        <option value="AC 310 gsm">AC 310 gsm</option>
        <option value="AC 400 gsm">AC 400 gsm</option>
      </select>
    </td>
  </tr>
  <tr>
    
    <td class="pr-2 py-2 whitespace-nowrap">Total dalam 1 A3+:</td>
    <td><input type="text" id="softcover-totalA3" class="ml-2 p-1 border rounded w-full bg-gray-100" readonly /></td>
  </tr>
  <tr>
    <td class="pr-2 py-2 whitespace-nowrap">Jumlah Lembar Cetak Isi:</td>
    <td><input type="text" id="softcover-lembar-isi" class="ml-2 p-1 border rounded w-full bg-gray-100" readonly /></td>
  </tr>
  <tr>
    <td class="pr-2 py-2 whitespace-nowrap">Ketebalan Punggung:</td>
    <td><input type="text" id="softcover-punggung" class="ml-2 p-1 border rounded w-full bg-gray-100" readonly /></td>
  </tr>
</table>

  <div class="mt-4">
   <button onclick="hitungSoftCover()" class="px-4 py-2 bg-blue-600 text-white rounded">Hitung</button>
   <button onclick="resetSoftcoverForm()" class="ml-2 px-4 py-2 bg-gray-500 text-white rounded">Reset</button>
  </div>
      </div>

 <!-- Booklet -->

<div id="form-booklet" class="form-buku hidden">
  <h3 class="font-bold mb-2">Estimasi Buku - Booklet</h3>
  <table class="mb-4 w-[400px]">
    <tr>
      
      <td class="pr-2 py-2 whitespace-nowrap">Jumlah Halaman:</td>
      <td><input type="number" id="booklet-halaman" class="ml-2 p-1 border rounded w-full" /></td>
    </tr>
    <tr>

      <td class="pr-2 py-2 whitespace-nowrap">Jumlah Cetak:</td>
      <td><input type="number" id="booklet-cetak" class="ml-2 p-1 border rounded w-full" /></td>
    </tr>

      <td class="pr-2 py-2 whitespace-nowrap">Ukuran Jadi (cm):</td>
      <td>

        <div class="flex ml-2 w-full">
          <input type="number" placeholder="Panjang" id="booklet-panjang" class="p-1 border rounded w-1/2 mr-1" />
          <span class="flex items-center px-1">x</span>
          <input type="number" placeholder="Lebar" id="booklet-lebar" class="p-1 border rounded w-1/2 ml-1" />
        </div>
      </td>
    </tr>
    <tr>

    <td class="pr-2 py-2 whitespace-nowrap">Orientation:</td>
    <td>
      <select id="booklet-orientation" class="ml-2 p-1 border rounded w-full">
        <option value="">-- None --</option>
        <option value="1">Portrait</option>
        <option value="2">Landscape</option>
      </select>
    </td>
  </tr>
  <tr>

    <td class="pr-2 py-2 whitespace-nowrap">Sided Print-Isi:</td>
    <td>
      <select id="booklet-sisi-isi" class="ml-2 p-1 border rounded w-full">
        <option value="">-- slide --</option>
        <option value="1">1 Sisi</option>
        <option value="2">2 Sisi</option>
      </select>
    </td>
  </tr>
  <tr>
    <td class="pr-2 py-2 whitespace-nowrap">Sided Print-Cover:</td>
    <td>
      <select id="booklet-sisi-cover" class="ml-2 p-1 border rounded w-full">
        <option value="">-- slide --</option>
        <option value="1">1 Sisi</option>
        <option value="2">2 Sisi</option>
      </select>
    </td>
  </tr>
  <tr>

    <td class="pr-2 py-2 whitespace-nowrap">Total dalam 1 A3+:</td>
    <td><input type="text" id="booklet-totalA3" class="ml-2 p-1 border rounded w-full bg-gray-100" readonly /></td>
  </tr>
  <tr>

    <td class="pr-2 py-2 whitespace-nowrap">Jumlah Lembar Cetak Isi:</td>
    <td><input type="text" id="booklet-lembar-isi" class="ml-2 p-1 border rounded w-full bg-gray-100" readonly /></td>
  </tr>
  <tr>

    <td class="pr-2 py-2 whitespace-nowrap">Jumlah Lembar Cetak Cover:</td>
    <td><input type="text" id="booklet-lembar-cover" class="ml-2 p-1 border rounded w-full bg-gray-100" readonly /></td>
  </tr>
  <tr>
  </table>

  <div class="mt-4">
    <button onclick="alert('Perhitungan Booklet belum diimplementasikan.');" class="px-4 py-2 bg-blue-600 text-white rounded">Hitung</button>
    <button onclick="resetBookletForm()" class="ml-2 px-4 py-2 bg-gray-500 text-white rounded">Reset</button>
  </div>
</div>

<!-- Spiral -->

<div id="form-spiral" class="form-buku hidden">
  <h3 class="font-bold mb-2">Estimasi Buku - Spiral</h3>
  <table class="mb-4 w-[400px]">
    <tr>

      <td class="pr-2 py-2 whitespace-nowrap">Jumlah Halaman:</td>
      <td><input type="number" id="spiral-halaman" class="ml-2 p-1 border rounded w-full" /></td>
    </tr>
    <tr>

      <td class="pr-2 py-2 whitespace-nowrap">Jumlah Cetak:</td>
      <td><input type="number" id="spiral-cetak" class="ml-2 p-1 border rounded w-full" /></td>
    </tr>

      <td class="pr-2 py-2 whitespace-nowrap">Ukuran Jadi (cm):</td>
      <td>

        <div class="flex ml-2 w-full">
          <input type="number" placeholder="Panjang" id="spiral-panjang" class="p-1 border rounded w-1/2 mr-1" />
          <span class="flex items-center px-1">x</span>
          <input type="number" placeholder="Lebar" id="spiral-lebar" class="p-1 border rounded w-1/2 ml-1" />
        </div>
      </td>
    </tr>
    <tr>
<tr>
  
  <td class="pr-2 py-2 whitespace-nowrap">Sided Print-Isi:</td>
  <td>
    <div class="flex ml-2 w-full">
      <select id="spiral-sisi-isi" class="p-1 border rounded w-1/2 mr-1" />
        <option value="">-- slide --</option>
        <option value="1">1 Sisi</option>
        <option value="2">2 Sisi</option>
      </select>
      <select id="spiral-bahan-isi" class="p-1 border rounded w-1/2 ml-1" />
        <option value="">- Pilih Kertas -</option>
        <option value="BOOK PAPER">BOOK PAPER</option>
        <option value="HVS 75 gsm">HVS 75 gsm</option>
        <option value="HVS 80 gsm">HVS 80 gsm</option>
        <option value="HVS 100 gsm">HVS 100 gsm</option>
        <option value="AP 120 gsm">AP 120 gsm</option>
        <option value="AP 150 gsm">AP 150 gsm</option>
        <option value="MP 120 gsm">MP 120 gsm</option>
        <option value="MP 150 gsm">MP 150 gsm</option>
        <option value="AC 210 gsm">AC 210 gsm</option>
        <option value="AC 230 gsm">AC 230 gsm</option>
        <option value="AC 260 gsm">AC 260 gsm</option>
        <option value="AC 310 gsm">AC 310 gsm</option>
        <option value="AC 400 gsm">AC 400 gsm</option>
      </select>
    </div>
  </td>
</tr>

<tr>
  <td class="pr-2 py-2 whitespace-nowrap">Sided Print-Cover:</td>
  <td>
    <div class="flex ml-2 w-full">
      <select id="spiral-sisi-cover" class="p-1 border rounded w-full mr-1" />
        <option value="">-- slide --</option>
        <option value="1">1 Sisi</option>
        <option value="2">2 Sisi</option>
      </select>
      <select id="spiral-bahan-cover" class="p-1 border rounded w-60 ml-1" />
        <option value="">- Pilih Kertas -</option>
        <option value="BOOK PAPER">BOOK PAPER</option>
        <option value="HVS 75 gsm">HVS 75 gsm</option>
        <option value="HVS 80 gsm">HVS 80 gsm</option>
        <option value="HVS 100 gsm">HVS 100 gsm</option>
        <option value="AP 120 gsm">AP 120 gsm</option>
        <option value="AP 150 gsm">AP 150 gsm</option>
        <option value="MP 120 gsm">MP 120 gsm</option>
        <option value="MP 150 gsm">MP 150 gsm</option>
        <option value="AC 210 gsm">AC 210 gsm</option>
        <option value="AC 230 gsm">AC 230 gsm</option>
        <option value="AC 260 gsm">AC 260 gsm</option>
        <option value="AC 310 gsm">AC 310 gsm</option>
        <option value="AC 400 gsm">AC 400 gsm</option>
      </select>
    </div>
  </td>
</tr>

    <td class="pr-2 py-2 whitespace-nowrap">Total dalam 1 A3+:</td>
    <td><input type="text" id="spiral-totalA3" class="ml-2 p-1 border rounded w-full bg-gray-100" readonly /></td>
  </tr>
  <tr>

    <td class="pr-2 py-2 whitespace-nowrap">Jumlah Lembar Cetak Isi:</td>
    <td><input type="text" id="spiral-lembar-isi" class="ml-2 p-1 border rounded w-full bg-gray-100" readonly /></td>
  </tr>
  <tr>

    <td class="pr-2 py-2 whitespace-nowrap">Jumlah Lembar Cetak Cover:</td>
    <td><input type="text" id="spiral-lembar-cover" class="ml-2 p-1 border rounded w-full bg-gray-100" readonly /></td>
  </tr>
  <tr>

    <td class="pr-2 py-2 whitespace-nowrap">Nomor Spiral:</td>
    <td><input type="text" id="spiral-nomor-spiral" class="ml-2 p-1 border rounded w-full bg-gray-100" readonly /></td>
  </tr>
  <tr>
  </table>

  <div class="mt-4">
    <button onclick="hitungSpiral()" class="px-4 py-2 bg-blue-600 text-white rounded">Hitung</button>
    <button onclick="resetSpiralForm()" class="ml-2 px-4 py-2 bg-gray-500 text-white rounded">Reset</button>
  </div>
</div>
<script>

<!-- Rumus + Tombol -->

 <!-- Estimasi Layout A3+ -->
  function getHargaPotongKress(kebutuhan, totalA3) {
  const data = [
    { maxA3: 2, ranges: [  // total dalam 1 A3: 1–2
      { maxK: 5, harga: 0 },
      { maxK: 10, harga: 5000 },
      { maxK: 50, harga: 10000 },
      { maxK: 100, harga: 15000 },
      { maxK: 200, harga: 20000 },
      { maxK: 300, harga: 25000 },
      { maxK: Infinity, harga: 30000 }
    ]},
    { maxA3: 8, ranges: [  // total dalam 1 A3: 3–8
      { maxK: 5, harga: 0 },
      { maxK: 10, harga: 5000 },
      { maxK: 30, harga: 10000 },
      { maxK: 50, harga: 15000 },
      { maxK: 100, harga: 20000 },
      { maxK: 200, harga: 25000 },
      { maxK: 300, harga: 30000 },
      { maxK: Infinity, harga: 35000 }
    ]},
    { maxA3: 15, ranges: [  // total dalam 1 A3: 9–15
      { maxK: 5, harga: "1000/LEMBAR" },
      { maxK: 10, harga: 10000 },
      { maxK: 30, harga: 20000 },
      { maxK: 50, harga: 35000 },
      { maxK: 100, harga: 40000 },
      { maxK: 200, harga: 50000 },
      { maxK: 300, harga: 60000 },
      { maxK: Infinity, harga: 70000 }
    ]},
    { maxA3: 25, ranges: [  // total dalam 1 A3: 16–25
      { maxK: 5, harga: "3000/LEMBAR" },
      { maxK: 10, harga: 15000 },
      { maxK: 30, harga: 25000 },
      { maxK: 50, harga: 35000 },
      { maxK: 100, harga: 45000 },
      { maxK: 200, harga: 55000 },
      { maxK: 300, harga: 65000 },
      { maxK: Infinity, harga: 75000 }
    ]},
    { maxA3: Infinity, ranges: [  // total dalam 1 A3: 26+
      { maxK: 5, harga: "4000/LEMBAR" },
      { maxK: 10, harga: 20000 },
      { maxK: 30, harga: 30000 },
      { maxK: 50, harga: 40000 },
      { maxK: 100, harga: 50000 },
      { maxK: 200, harga: 60000 },
      { maxK: 300, harga: 70000 },
      { maxK: Infinity, harga: 80000 }
    ]}
  ];

  const baris = data.find(d => totalA3 <= d.maxA3);
  if (!baris) return 0;
  const kolom = baris.ranges.find(r => kebutuhan <= r.maxK);
  return kolom ? kolom.harga : 0;
}

    function hitungTotal() {
      let panjang = parseFloat(document.getElementById('panjang').value);
      let lebar = parseFloat(document.getElementById('lebar').value);
      const kebutuhan = parseFloat(document.getElementById('kebutuhan').value);
      const finishing = document.getElementById('finishing').value;

      let panjangAcuan = 47;
      let lebarAcuan = 31;

      if (isNaN(panjang) || isNaN(lebar) || panjang <= 0 || lebar <= 0) {
        alert('Isi panjang dan lebar dengan benar.');
        return;
      }

      if (finishing === "Potong Kotak Kress 2") {
        panjang += 0.4;
        lebar += 0.4;
        panjangAcuan = 47.4;
        lebarAcuan = 31.4;
      }

      if (finishing === "Kiss Cut") {
        panjang += 0.2;
        lebar += 0.2;
        panjangAcuan = 45.2;
        lebarAcuan = 30.7;
      }

      if (finishing === "Die Cut") {
        panjang += 0.4;
        lebar += 0.4;
        const mode1 = Math.floor(44 / panjang) * Math.floor(30.8 / lebar);
        const mode2 = Math.floor(44 / lebar) * Math.floor(30.8 / panjang);
        const mode3 = Math.floor(46.5 / panjang) * Math.floor(29 / lebar);
        const mode4 = Math.floor(46.5 / lebar) * Math.floor(29 / panjang);
        var totalA3 = Math.max(mode1, mode2, mode3, mode4);
      } else {
        const mode1 = Math.floor(panjangAcuan / panjang) * Math.floor(lebarAcuan / lebar);
        const mode2 = Math.floor(panjangAcuan / lebar) * Math.floor(lebarAcuan / panjang);
        var totalA3 = Math.max(mode1, mode2);
      }

        const a3plus = totalA3 > 0 && kebutuhan > 0 ? Math.ceil(kebutuhan / totalA3) : 0;
        let harga = 0;
        if (finishing === "Kiss Cut") {
        harga = 5500 * a3plus;
      } else if (finishing === "Die Cut") {
        harga = 8500 * a3plus;
      } else if (finishing === "Potong Kotak Kress 1" || finishing === "Potong Kotak Kress 2") {
        const hargaData = getHargaPotongKress(a3plus, totalA3);
        if (typeof hargaData === "string" && hargaData.includes("/LEMBAR")) {
        harga = parseInt(hargaData) * a3plus;
      } else {
        harga = hargaData;
      }
    }

      const total = harga;
      document.getElementById('hasilTotalA3').value = totalA3 > 0 ? totalA3 + ' pcs' : '-';
      document.getElementById('hasilA3plus').value = a3plus > 0 ? a3plus + ' Lembar' : '-';
      document.getElementById('totalFinishing').value = total > 0 ? 'Rp' + total.toLocaleString() : 'FREE';
    }

    function resetForm() {
      document.getElementById('panjang').value = '';
      document.getElementById('lebar').value = '';
      document.getElementById('kebutuhan').value = '';
      document.getElementById('finishing').value = '';
      document.getElementById('hasilTotalA3').value = '';
      document.getElementById('hasilA3plus').value = '';
      document.getElementById('totalFinishing').value = '';
    }
  </script>

<script>
  function showSection(id) {
    document.querySelectorAll('.section').forEach(section => {
      section.classList.add('hidden');
    });
    document.getElementById(id).classList.remove('hidden');
   }
    function tampilkanFormBuku() {
    const jenis = document.getElementById('jenis-buku').value;
    document.querySelectorAll('.form-buku').forEach(form => form.classList.add('hidden'));
    document.getElementById(`form-${jenis}`).classList.remove('hidden');
  }

<!-- Estimasi Buku - Soft Cover -->

function hitungSoftCover() {
  const halaman = parseInt(document.getElementById('softcover-halaman').value);
  const panjang = parseFloat(document.getElementById('softcover-panjang').value);
  const lebar = parseFloat(document.getElementById('softcover-lebar').value);
  const cetak = parseInt(document.getElementById('softcover-cetak').value);
  const sisiIsi = document.getElementById('softcover-sisi-isi').value;
  const sisiCover = document.getElementById('softcover-sisi-cover').value;
  const bahanIsi = document.getElementById('softcover-bahan-isi').value;

  if (!halaman || !panjang || !lebar || !cetak || !sisiIsi || !sisiCover || !bahanIsi) {
    alert('Lengkapi semua input Soft Cover.');
    return;
  }

  // Dimensi cetak ditambah 0.4 cm
  const panjangCetak = panjang + 0.4;
  const lebarCetak = lebar + 0.4;

  const acuanPanjang = 47.4;
  const acuanLebar = 31.4;

  const fit1 = Math.floor(acuanPanjang / panjangCetak) * Math.floor(acuanLebar / lebarCetak);
  const fit2 = Math.floor(acuanPanjang / lebarCetak) * Math.floor(acuanLebar / panjangCetak);
  const totalA3 = Math.max(fit1, fit2);

  document.getElementById('softcover-totalA3').value = totalA3 > 0 ? totalA3 + ' pcs' : '-';

  // Hitung halaman isi
  let halamanIsi = halaman;
  if (sisiIsi === "1" && sisiCover === "2") {
    halamanIsi -= 4;
  } else if (sisiIsi === "1") {
    halamanIsi -= 2;
  } else if (sisiIsi === "2" && sisiCover === "2") {
    halamanIsi = (halaman - 4) / 2;
  } else if (sisiIsi === "2") {
    halamanIsi = (halaman - 2) / 2;
  }

  // Hitung lembar cetak isi
  const totalIsi = halamanIsi * cetak;
  const lembarIsi = Math.ceil(totalIsi / totalA3);
  document.getElementById('softcover-lembar-isi').value = lembarIsi + ' Lembar';

  // Ketebalan bahan berdasarkan referensi
  const ketebalanBahan = {
    "BOOK PAPER": 0.0125,
    "HVS 75 gsm": 0.0093,
    "HVS 80 gsm": 0.01041,
    "HVS 100 gsm": 0.01234,
    "AP 120 gsm": 0.013,
    "AP 150 gsm": 0.0142,
    "MP 120 gsm": 0.0131,
    "MP 150 gsm": 0.0142,
    "AC 210 gsm": 0.023,
    "AC 230 gsm": 0.025,
    "AC 260 gsm": 0.03125,
    "AC 310 gsm": 0.036,
    "AC 400 gsm": 0.05
  };

  const ketebalan = ketebalanBahan[bahanIsi] || 0;
  let totalHalaman = halaman;

  // Hitung ketebalan punggung
  let totalPunggung = 0;
  if (sisiIsi === "1" && sisiCover === "1") {
    totalPunggung = (halaman - 2) * ketebalan;
  } else if (sisiIsi === "2" && sisiCover === "1") {
    totalPunggung = ((halaman - 2) / 2) * ketebalan;
  } else if (sisiIsi === "1" && sisiCover === "2") {
    totalPunggung = (halaman - 4) * ketebalan;
  } else if (sisiIsi === "2" && sisiCover === "2") {
    totalPunggung = ((halaman - 4) / 2) * ketebalan;
  }
  document.getElementById('softcover-punggung').value = totalPunggung.toFixed(2) + ' cm';
}

function resetSoftcoverForm() {
  const ids = [
    'softcover-halaman', 'softcover-panjang', 'softcover-lebar', 'softcover-cetak',
    'softcover-sisi-isi', 'softcover-sisi-cover', 'softcover-bahan-isi', 'softcover-bahan-cover',
    'softcover-totalA3', 'softcover-lembar-isi', 'softcover-punggung'
  ];

  ids.forEach(id => {
    const el = document.getElementById(id);
    if (el) el.value = (el.tagName === 'SELECT') ? el.options[0].value : '';
  });
}

<!-- Estimasi Buku - Spiral -->

function hitungSpiral() {
  const halaman = parseInt(document.getElementById('spiral-halaman').value);
  const panjang = parseFloat(document.getElementById('spiral-panjang').value);
  const lebar = parseFloat(document.getElementById('spiral-lebar').value);
  const cetak = parseInt(document.getElementById('spiral-cetak').value);
  const sisiIsi = document.getElementById('spiral-sisi-isi').value;
  const sisiCover = document.getElementById('spiral-sisi-cover').value;
  const bahanIsi = document.getElementById('spiral-bahan-isi').value;
  const bahanCover = document.getElementById('spiral-bahan-cover').value;

  if (!halaman || !panjang || !lebar || !cetak || !sisiIsi || !sisiCover || !bahanIsi || !bahanCover) {
    alert('Lengkapi semua input Spiral.');
    return;
  }

  // Dimensi cetak +0.4cm
  const panjangCetak = panjang + 0.4;
  const lebarCetak = lebar + 0.4;
  const acuanPanjang = 47.4;
  const acuanLebar = 31.4;

  const fit1 = Math.floor(acuanPanjang / panjangCetak) * Math.floor(acuanLebar / lebarCetak);
  const fit2 = Math.floor(acuanPanjang / lebarCetak) * Math.floor(acuanLebar / panjangCetak);
  const totalA3 = Math.max(fit1, fit2);

  document.getElementById('spiral-totalA3').value = totalA3 > 0 ? totalA3 + ' pcs' : '-';

  // Hitung halaman isi
  let halamanIsi = halaman;
  if (sisiIsi === "1" && sisiCover === "2") {
    halamanIsi -= 4;
  } else if (sisiIsi === "1") {
    halamanIsi -= 2;
  } else if (sisiIsi === "2" && sisiCover === "2") {
    halamanIsi = (halaman - 4) / 2;
  } else if (sisiIsi === "2") {
    halamanIsi = (halaman - 2) / 2;
  }

  // Hitung halaman cover
  let halamanCover = 0;
  if (sisiCover === "1") {
    halamanCover = 2;
  } else if (sisiCover === "2") {
    halamanCover = 4;
  }

  const totalIsi = halamanIsi * cetak;
  const lembarIsi = Math.ceil(totalIsi / totalA3);
  document.getElementById('spiral-lembar-isi').value = lembarIsi + ' Lembar';

  const totalCover = halamanCover * cetak;
  const lembarCover = Math.ceil(totalCover / totalA3);
  document.getElementById('spiral-lembar-cover').value = lembarCover + ' Lembar';

  // Panggil otomatis hitung ketebalan + nomor spiral
  hitungKetebalanSpiral();
}

function hitungKetebalanSpiral() {
  const halaman = parseInt(document.getElementById('spiral-halaman').value);
  const sisiIsi = document.getElementById('spiral-sisi-isi').value;
  const sisiCover = document.getElementById('spiral-sisi-cover').value;
  const bahanIsi = document.getElementById('spiral-bahan-isi').value;
  const bahanCover = document.getElementById('spiral-bahan-cover').value;

  if (!halaman || !sisiIsi || !sisiCover || !bahanIsi || !bahanCover) {
    return;
  }

  const ketebalanBahan = {
    "BOOK PAPER": 0.0125,
    "HVS 75 gsm": 0.0093,
    "HVS 80 gsm": 0.01041,
    "HVS 100 gsm": 0.01234,
    "AP 120 gsm": 0.013,
    "AP 150 gsm": 0.0142,
    "MP 120 gsm": 0.0131,
    "MP 150 gsm": 0.0142,
    "AC 210 gsm": 0.023,
    "AC 230 gsm": 0.025,
    "AC 260 gsm": 0.03125,
    "AC 310 gsm": 0.036,
    "AC 400 gsm": 0.05
  };

  const ketebalanIsi = ketebalanBahan[bahanIsi] || 0;
  const ketebalanCover = ketebalanBahan[bahanCover] || 0;

  let halamanIsi = halaman;
  if (sisiIsi === "1" && sisiCover === "1") {
    halamanIsi = halaman - 2;
  } else if (sisiIsi === "1" && sisiCover === "2") {
    halamanIsi = halaman - 4;
  } else if (sisiIsi === "2" && sisiCover === "1") {
    halamanIsi = (halaman - 2) / 2;
  } else if (sisiIsi === "2" && sisiCover === "2") {
    halamanIsi = (halaman - 4) / 2;
  }

  const totalPunggung = (halamanIsi * ketebalanIsi) + (2 * ketebalanCover);

  let nomorSpiral = '-';
  if (totalPunggung <= 0.5) nomorSpiral = '5';
  else if (totalPunggung <= 0.7) nomorSpiral = '6';
  else if (totalPunggung <= 0.8) nomorSpiral = '7';
  else if (totalPunggung <= 0.9) nomorSpiral = '8';
  else if (totalPunggung <= 1.1) nomorSpiral = '9';
  else if (totalPunggung <= 1.3) nomorSpiral = '10';
  else if (totalPunggung <= 1.6) nomorSpiral = '12';
  else if (totalPunggung <= 1.8) nomorSpiral = '14';
  else if (totalPunggung <= 2.1) nomorSpiral = '16';
  else if (totalPunggung <= 2.6) nomorSpiral = '20';

  document.getElementById('spiral-nomor-spiral').value = nomorSpiral;
}

function resetSpiralForm() {
  const ids = [
    'spiral-halaman', 'spiral-panjang', 'spiral-lebar', 'spiral-cetak',
    'spiral-sisi-isi', 'spiral-sisi-cover', 'spiral-bahan-isi', 'spiral-bahan-cover',
    'spiral-totalA3', 'spiral-lembar-isi', 'spiral-lembar-cover', 'spiral-nomor-spiral'
  ];
  ids.forEach(id => {
    const el = document.getElementById(id);
    if (el) {
      if (el.tagName === 'SELECT') {
        el.selectedIndex = 0;
      } else {
        el.value = '';
      }
    }
  });
}
</script>

</body>
</html>
